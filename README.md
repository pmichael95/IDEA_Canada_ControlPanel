# Getting started

To start working with the system you first need to install:

If you are on linux: (you are lucky)
you need python(this is already installed)
-pip
-flask
-flask-sqlalchemy

just run these commands on the terminal

```
> chmod 755 setup.sh

> ./setup.sh
```

this will install everything you need
and you are good to go.

if you are on windows:
um...
you need to install:
- python
- pip
- flask
- flask-sqlalchemy


# Running the server

> python app.py

this will start the local server(don't use in production)
and if you go type 127.0.0.1:5000/ in your browser, you can see stuff.


# Important files

app.py:  the base file that runs the server
database.cfg the config file to set up the database name and secret keys
database.py the file that creates and links to the database
models.py a model is a mapping between a table in the database and a class in python
views/ all the logic and code for each url. for example login.py is /login, dashboard.py is /dashboard
templates/ all the html that will be injected by corresponding view file. for example login.py renders the login.html file
static/ all the css,js, and imgs that are used in the html
utils.py the file that has all the utility

# How the app works

## The whole things works on the idea of MVT(Models, Views, Templates)

Models: the mapping between the database tables and python class. It is the interface to the database
Views: (Not the same as views in mvc). The views are the logic/controller of the app
Templates: the html, the interface to the app. Templates are not regular html files. So you can't just open them normally. The html/templates gets generated by the app/server


## Understanding the url mappings
/login maps to views/login.py
/register maps to views/register.py
/settings maps to views/settings.py
/help maps to views/help.py
etc...

if you want to add new urls and mappings
then create a new python file. the filename doesn't have to be the same as the url
for example if you want to make a /donate url, your file doesn't have to be donate.py
but it makes it clearer to use donate.py

So lets say we have a donate.py file
place that file in the views/ directory

then you need to make a variable that maps to this page.
you can find examples in the other views file. (e.g login.py, register.py)

so the variable would be something like this
> donate_page = Blueprint('donate', __name__, template_folder='../templates', static_folder='static')

then you would need to import some flask stuff
so go ahead and import some stuff like the following:
> from flask import Flask, Blueprint, render_template, url_for, request, session, redirect

you might not need all those things like redirect, and session

Next thing is to put the url mapping to a function

so we would need to tell that variable to add a url route.
we do this like this

> @donate_page.route('/donate')
this tells the variable what the url should be
next we need a function to execute when the browser comes to this url

you can call the function whatever you want, but lets call it show
> def show():
>    params = dict(header_title='This is the title for the site')

header_title is a variable we are going to use in the template. just hold on. ill get there.
the params variable is just all the variables, the template stuff will take
 then we need to tell the function to render a template to the screen/browser.

we do this by telling it:
> return render_template("donate.html", **params)

the first parameter is the html file/template you want to render. this file should be in the templates/ directory.
the second parameter is all the variables that will be passed in to the template
the params dictionary object gets passed in to the render template.

this is the basics of url routing, and passing variables to templates.
this is good because in our function we can make a call to the database, get some data, and add that data to the template

now we need a template for this url.
so in the templates/ directory lets make a file. and because we said donate.html in the view function called "donate.html"
we will make that in the templates folder.

the donate.html is not a regular html file, it is a template.

in our templates folder we have a base.html file. all new and other template files will inherit from this file.
to do this we need to extend the donate.html file. We can do this by putting this line at the top of the donate.html file

{% extends 'base.html' %}

this tells the templating system to let donate.html to inherit from base.html.

now this is where it gets a little comlicated. the templating system is called jinja2

to get a more in depth view how jinja works. look at this link
http://jinja.pocoo.org/docs/

you can type normal html code in this donate.html file, but if you want to make the page dynamic,
and want to inject data from lets say a database, then we can do that.

remember the params we passed from the donate.py file, well we have access to them in here
in order to inject that data into the page, into lets say a h1 tag we need to do

<h1>{{ header_title }}</h1>

the {{ }} tells the templating system to go look for a python variable names header_title
remember when we passed in header_title from the view function

well now in the html it gets rendered to
<h1>This is the title for the site</h1>

Basically we are injecting data from our python file into the html file.
from this basic idea we can inject our data from the database into the html, and build awesome dynamic sites.

you can even do some basic python code in the template.
for example:
<ul>
{% for user in users %}
  <li><a href="{{ user.url }}">{{ user.username }}</a></li>
{% endfor %}
</ul>


this makes a bunch a li item with data populated from a user list variable from python
you can do for loops, if conditions, and other stuff.

this loop won't work unless we have a users variable.

now getting back to the donate.py file, we need to do this.

> all_users = [{'url': 'site.com/user1','username': 'user1'}, {'url': 'site.com/user2','username': 'user2'}]]
> dict(header_title="This is the title for the site", users=all_users)

we just passed in another variable called users into the template
when the templates get rendered we will have access to the users variable.

this is the basics of what is happening here

I suggest reading the documentation for jinja and flask
